# 모바일 환경 키보드 자동 띄우기 해결 방안

## 문제 상황
커서를 오늘 섹션으로 이동시켜도 모바일에서 키보드가 자동으로 뜨지 않아서 사용자가 화면을 직접 터치해야 입력을 시작할 수 있습니다.

---

## 해결 방안

### 방안 1: Editor Focus 명시적으로 설정
**방법:** 커서 이동 후 에디터에 focus()를 호출합니다.
```
editor.focus();
```

**장점:**
- 구현이 매우 간단함
- 표준 방식으로 많은 경우에 작동함

**단점:**
- Obsidian 모바일에서 완벽하게 작동하지 않을 수 있음
- 일부 모바일 브라우저는 보안상 제약이 있을 수 있음

---

### 방안 2: 딜레이 후 Focus 재시도
**방법:** setTimeout으로 약간의 딜레이를 준 후 포커스를 시도합니다.
```
setTimeout(() => editor.focus(), 100);
```

**장점:**
- UI 렌더링이 완료된 후 포커스하여 성공률 높임
- 간단한 추가 코드

**단점:**
- 여전히 모바일 환경에서 키보드가 안 뜰 수 있음
- 딜레이 시간 조절이 필요할 수 있음

---

### 방안 3: 모바일 플랫폼 감지 후 처리
**방법:** Obsidian의 Platform API를 사용해 모바일인 경우에만 특별 처리합니다.
```
if (this.app.isMobile) {
    // 모바일 전용 처리
}
```

**장점:**
- 플랫폼별로 다른 동작 가능
- 데스크톱에 영향 없음

**단점:**
- 모바일에서 정확히 무엇을 해야 할지 추가 연구 필요

---

### 방안 4: 빈 문자 입력으로 편집 모드 트리거
**방법:** 커서 이동 후 프로그래밍으로 아주 작은 변경을 만들어 편집 모드를 활성화합니다.
```
editor.replaceRange("", editor.getCursor(), editor.getCursor());
```

**장점:**
- 에디터를 "활성 편집 상태"로 만들 수 있음

**단점:**
- 의도치 않은 부작용 가능성
- 키보드가 뜨는 것과 직접적 연관 없을 수 있음

---

### 방안 5: 가상 키 입력 시뮬레이션
**방법:** 공백 문자를 삽입했다가 즉시 삭제하여 키보드 입력을 시뮬레이션합니다.
```
const cursor = editor.getCursor();
editor.replaceRange(" ", cursor);
editor.replaceRange("", cursor, { line: cursor.line, ch: cursor.ch + 1 });
```

**장점:**
- 실제 입력이 발생하므로 키보드가 뜰 가능성 높음

**단점:**
- Undo 기록에 남을 수 있음
- 깔끔한 해결책은 아님

---

### 방안 6: ContentEditable 요소에 직접 Focus
**방법:** Obsidian 에디터의 실제 DOM 요소를 찾아서 직접 포커스합니다.
```
const editorElement = view.contentEl.querySelector('.cm-content');
if (editorElement) {
    editorElement.focus();
}
```

**장점:**
- 더 저수준에서 제어
- 모바일 키보드 트리거 가능성 높음

**단점:**
- Obsidian 내부 구조 의존
- 버전 업데이트 시 깨질 수 있음

---

### 방안 7: 터치 이벤트 시뮬레이션 (고급)
**방법:** 프로그래밍으로 터치 이벤트를 발생시켜 사용자가 화면을 터치한 것처럼 만듭니다.

**장점:**
- 실제 사용자 액션과 가장 유사
- 키보드가 뜰 확률 가장 높음

**단점:**
- 구현이 복잡함
- 모바일 OS 보안 정책에 막힐 수 있음
- 브라우저마다 동작이 다를 수 있음

---

### 방안 8: 사용자에게 알림 제공
**방법:** 모바일에서는 "화면을 터치하여 입력을 시작하세요"와 같은 안내 메시지를 표시합니다.

**장점:**
- 기술적 제약을 우회
- 사용자 경험에 명확한 가이드 제공
- 구현이 확실함

**단점:**
- 완전 자동화는 아님
- 사용자가 한 번 더 액션해야 함

---

### 방안 9: Obsidian 모바일 API 활용
**방법:** Obsidian이 제공하는 모바일 전용 API나 메서드가 있는지 확인하고 활용합니다.

**장점:**
- 공식 지원으로 안정적
- 호환성 보장

**단점:**
- 해당 API가 존재하는지 확인 필요
- 문서화되지 않았을 수 있음

---

## 추천 순서

### 1순위: 방안 1 + 방안 2 조합
먼저 간단하게 `editor.focus()`를 시도하고, 딜레이를 주는 방식을 함께 테스트합니다.

### 2순위: 방안 6 시도
CodeMirror의 실제 DOM 요소에 직접 포커스하는 방식을 시도합니다.

### 3순위: 방안 3 + 방안 8 조합
모바일인 경우 감지해서 사용자에게 친절한 안내를 제공하는 현실적 접근을 취합니다.

---

## 실험 필요
각 방안의 실제 효과는 Obsidian 모바일 앱에서 직접 테스트해봐야 정확히 알 수 있습니다. 여러 방안을 조합하는 것도 좋은 전략입니다.
